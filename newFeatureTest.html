<!DOCTYPE html>
<html>
<head>
  <style>
    /* Add some style to the svg elements */
    svg {
      width: 100%;
      height: 500px;
      border: 1px solid black;
    }

    line {
      stroke: black;
      stroke-width: 2px;
    }

    text {
      font-family: Arial, sans-serif;
      font-size: 14px;
    }

    .indent {
      margin-left: 20px;
    }
  </style>
</head>
<body>
  <h1>LUL Language</h1>
  <p>Write a list of events and see them as a timeline.</p>
  <textarea id="input" rows="10" cols="50">
- Start
- Event 1
  - Subevent 1
  - Subevent 2
- Event 2
- Event 3
- End
</textarea>
  <button id="generate">Generate</button>
  <svg id="output"></svg>
  <script>
    // Get the input textarea, output svg, and generate button elements
    let input = document.getElementById("input");
    let output = document.getElementById("output");
    let generate = document.getElementById("generate");

    // Add a click event listener to the generate button
    generate.addEventListener("click", function() {
      // Clear the output svg
      output.innerHTML = "";

      // Get the input text and split it by line breaks
      let text = input.value;
      let lines = text.split("\n");

      // Initialize some variables for drawing the timeline
      let x = 50; // The x coordinate of the start point
      let y = 50; // The y coordinate of the start point
      let gap = 50; // The gap between each point
      let radius = 5; // The radius of each point

      // Loop through each line of the input text
      for (let i = 0; i < lines.length; i++) {
        // Get the current line and trim any whitespace
        let line = lines[i].trim();

        // Check if the line is not empty and not indented
        if (line && !line.startsWith("- ")) {
          // Draw a circle for the point
          let circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
          circle.setAttribute("cx", x);
          circle.setAttribute("cy", y);
          circle.setAttribute("r", radius);
          output.appendChild(circle);

          // Draw a text for the label
          let text = document.createElementNS("http://www.w3.org/2000/svg", "text");
          text.setAttribute("x", x + radius * 2);
          text.setAttribute("y", y + radius);
          text.textContent = line;
          output.appendChild(text);

          // Check if this is not the last line
          if (i < lines.length - 1) {
            // Draw a line for the next point
            let nextLine = lines[i + 1].trim();
            let nextY = y + gap;

            // Check if the next line is indented
            if (nextLine.startsWith("- ")) {
              // Adjust the next y coordinate to account for the indentation
              nextY += gap * countIndentations(lines, i + 1);
            }

            let line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("x1", x);
            line.setAttribute("y1", y + radius);
            line.setAttribute("x2", x);
            line.setAttribute("y2", nextY - radius);
            output.appendChild(line);

            // Update the y coordinate for the next point
            y = nextY;
          }
        }

        // Check if the line is indented
        if (line.startsWith("- ")) {
          // Draw a text for the sublabel under the point
          let text = document.createElementNS("http://www.w3.org/2000/svg", "text");
          text.setAttribute("x", x + radius * 4);
          text.setAttribute("y", y + radius * 4);
          text.textContent = line.substring(2);
          text.classList.add("indent");
          output.appendChild(text);

          // Update the y coordinate for the next sublabel
          y += gap / 2;
        }
      }
    });

    // A helper function that counts how many consecutive lines are indented from a given index
    function countIndentations(lines, index) {
      let count = 0;
      while (index < lines.length && lines[index].trim().startsWith("- ")) {
        count++;
        index++;
      }
      return count;
    }
    
</script>
</body>
</html>